import{r as e,c as t,h as o,g as i}from"./p-a21f6813.js";import{T as l}from"./p-c3aeca37.js";import{d as n}from"./p-12253190.js";import{d as s}from"./p-4ef13da1.js";import"./p-b683e35d.js";const c=class{constructor(o){e(this,o),this.fwExport=t(this,"fwExport",7),this.fwCloseExport=t(this,"fwCloseExport",7),this.SEARCH_COUNT=10,this.boolAddedClearFilterEvent=!1,this.allFieldsSelected=!1,this.arrSearchedFields=null,this.searching=!1,this.searchText="",this.clearFilter=!1,this.selectedFieldCount=0,this.isOpen=!1,this.value=null,this.resetStates=()=>{this.debouncedHandleInput=null,this.arrSearchedFields=null,this.searching=!1,this.searchText="",this.allFieldsSelected=!1,this.clearFilter=!1,this.selectedFieldCount=0,this.value=null},this.initializeSearchDebounce=()=>{this.debouncedHandleInput||(this.debouncedHandleInput=n(this.searchChangeHandler,this))},this.addClearFilterEvent=()=>{if(!this.boolAddedClearFilterEvent){const e=this.host.shadowRoot.querySelector(".clearExportFilter");e&&(this.boolAddedClearFilterEvent=!0,e.addEventListener("click",this.clearFiltersHandler))}},this.clearFiltersHandler=e=>{var t;e.stopImmediatePropagation(),e.stopPropagation(),(null===(t=this.value)||void 0===t?void 0:t.filter)&&(this.value.filter.value=!1),this.clearFilter=!0},this.searchChangeHandler=e=>{var t,o,i,l;e.stopImmediatePropagation(),e.stopPropagation();const n=(null===(o=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.value)||void 0===o?void 0:o.trim())||"";if(this.searchText=n,n&&(null===(l=null===(i=this.value)||void 0===i?void 0:i.fields)||void 0===l?void 0:l.length)>0){const e=n.toLowerCase(),t=this.value.fields.filter((function(t){return-1!==t.label.toLowerCase().indexOf(e)}));return this.searching=!0,void(this.arrSearchedFields=s(t))}this.searching=!1,this.arrSearchedFields=null},this.clearSearchHandler=e=>{e.stopImmediatePropagation(),e.stopPropagation(),this.arrSearchedFields=null,this.searching=!1,this.searchText=""},this.selectAllFieldsChangeHandler=e=>{var t,o;e.stopImmediatePropagation(),e.stopPropagation();const i=e.detail.meta.checked;if(this.allFieldsSelected=i,this.searching&&this.arrSearchedFields){const e=this.arrSearchedFields.length;for(let t=0;t<e;t++){const e=this.arrSearchedFields[t];Object.prototype.hasOwnProperty.call(e,"disabled")&&e.disabled||(this.arrSearchedFields[t]=Object.assign(Object.assign({},e),{selected:i}))}}if((null===(o=null===(t=this.value)||void 0===t?void 0:t.fields)||void 0===o?void 0:o.length)>0){const e=this.value.fields,t=e.length;for(let o=0;o<t;o++){const t=e[o];Object.prototype.hasOwnProperty.call(t,"disabled")&&t.disabled||(e[o]=Object.assign(Object.assign({},t),{selected:i}))}this.updateSelectedCount()}},this.fieldSelectionChangeHandler=e=>{var t,o;if(e.stopImmediatePropagation(),e.stopPropagation(),(null===(o=null===(t=this.value)||void 0===t?void 0:t.fields)||void 0===o?void 0:o.length)>0){const t=e.detail.checked,o=e.detail.value,i=this.value.fields.filter((e=>Object.prototype.hasOwnProperty.call(e,"id")&&e.id===o));i&&i.length>0&&(i[0].selected=t,this.updateSelectedCount())}},this.closeModalHandler=e=>{e.stopImmediatePropagation(),e.stopPropagation(),this.fwCloseExport.emit()},this.exportHandler=e=>{e.stopImmediatePropagation(),e.stopPropagation(),this.fwExport.emit({value:s(this.value)})},this.exportFormatChangeHandler=e=>{var t,o;e.stopImmediatePropagation(),e.stopPropagation();const i=null===(t=null==e?void 0:e.detail)||void 0===t?void 0:t.value;i&&""!==i&&(null===(o=this.value)||void 0===o?void 0:o.formats)&&(this.value.formats.selectedValue=i)}}async close(){return this.resetStates(),this.isOpen=!1,!0}async open(){return this.initializeSearchDebounce(),this.isOpen=!0,!0}componentWillLoad(){var e,t;const o=(null===(t=null===(e=this.value)||void 0===e?void 0:e.filter)||void 0===t?void 0:t.value)||!1;this.clearFilter=!o,this.updateSelectedCount(),this.initializeSearchDebounce()}componentDidUpdate(){this.addClearFilterEvent()}disconnectedCallback(){this.resetStates()}updateSelectedCount(){var e,t;if((null===(t=null===(e=this.value)||void 0===e?void 0:e.fields)||void 0===t?void 0:t.length)>0){const e=this.value.fields,t=e.filter((e=>Object.prototype.hasOwnProperty.call(e,"selected")&&!0===e.selected)),o=(null==t?void 0:t.length)||0;this.selectedFieldCount=o,this.allFieldsSelected=o===e.length}else this.selectedFieldCount=0,this.allFieldsSelected=!1}renderCheckboxField(e){return o("fw-co-export-field",{key:this.searching&&this.searchText&&""!==this.searchText?`search_${this.searchText}_${e.id}`:`${e.id}`,value:e,onFwChange:this.fieldSelectionChangeHandler})}render(){var e,t,i;const n=this.isOpen?null===(e=this.value)||void 0===e?void 0:e.filter:null,s=!(this.clearFilter||!n),c=s?l.t("export.filterInfo",{filtered:n.filtered,total:n.total}):"",r=(null===(t=this.value)||void 0===t?void 0:t.formats)||null,d=r?r.selectedValue:"",x=r&&(null==r?void 0:r.options)||null,p=this.searching?this.arrSearchedFields:(null===(i=this.value)||void 0===i?void 0:i.fields)||null,a=p?p.length:0,h=this.searching||a>this.SEARCH_COUNT,f=h&&this.searching&&a<=0,b=a<=this.SEARCH_COUNT?a:Math.ceil(a/2),u=(h?a-b:0)>0,m=b>0?p.slice(0,b).map((e=>this.renderCheckboxField(e))):null,g=u?p.slice(b+1).map((e=>this.renderCheckboxField(e))):null;let v="co-export-content";s||(v+=" co-export-content--without-filter");let w="co-export-field-content-fields-column1";return u||(w+=" co-export-field-content-fields-column1--full-width"),o("fw-modal",{isOpen:this.isOpen,slider:!0,icon:"download",titleText:l.t("export.modalTitle"),onFwClose:this.closeModalHandler},o("fw-modal-content",{class:"co-export-modal-content"},o("div",{class:v},s&&o("fw-inline-message",{open:!0,type:"info",closable:!1},o("span",{innerHTML:c})),o("div",{class:"co-export-format"},o("span",{class:"co-export-format-label"},l.t("export.exportFormat")),x&&x.length>0&&o("fw-radio-group",{orientation:"row",value:d,onFwChange:this.exportFormatChangeHandler},x.map((e=>o("fw-radio",{value:e.value},e.label))))),o("div",{class:"co-export-field-selection"},o("div",{class:"co-export-field-header"},o("span",{class:"co-export-field-header-label"},l.t("export.fields")),o("span",{class:"co-export-field-header-selected-count-label"},l.t("export.selectedFields",{count:this.selectedFieldCount}))),o("div",{class:"co-export-field-content"},o("div",{class:"co-export-field-content-header"},o("fw-checkbox",{class:"co-export-field-select-all",checked:this.allFieldsSelected,onFwChange:this.selectAllFieldsChangeHandler},o("span",{class:"co-export-field-select-all-label"},l.t("export.selectAllFields"))),h&&o("fw-input",{"clear-input":!0,"icon-left":"search",placeholder:l.t("export.searchFieldsPrompt"),onFwInput:this.debouncedHandleInput,onFwInputClear:this.clearSearchHandler,class:"co-export-field-search"})),o("div",{class:"co-export-field-content-fields"},!f&&o("div",{class:w},m),!f&&u&&o("div",{class:"co-export-field-content-fields-column2"},g),f&&o("span",{class:"co-export-field-empty-search-message"},l.t("export.noSearchResults"))))))),o("fw-modal-footer",null,o("span",{class:"co-export-modal-footer"},o("fw-button",{color:"secondary",onFwClick:this.closeModalHandler},l.t("export.cancelButton")),o("fw-button",{onFwClick:this.exportHandler},l.t("export.submitButton")))))}get host(){return i(this)}};c.style=':host{font-family:var(--fw-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", roboto, oxygen, ubuntu, cantarell, "Open Sans", "Helvetica Neue", sans-serif);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{display:block;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-modal-content{height:100%;overflow:hidden}.co-export-content{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-padding-before:20px;padding-block-start:20px;gap:24px}.co-export-content .clearExportFilter{font-weight:700;color:#2c5cc5;cursor:pointer}.co-export-content .co-export-format{width:100%;height:auto;display:-ms-flexbox;display:flex;gap:24px;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-content .co-export-format .co-export-format-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#475867;font-size:14px;line-height:20px;margin:0}.co-export-content .co-export-field-selection{width:100%;height:auto;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;gap:10px}.co-export-content .co-export-field-selection .co-export-field-header{width:100%;height:20px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-content .co-export-field-selection .co-export-field-header .co-export-field-header-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-weight:600;font-size:14px;line-height:20px}.co-export-content .co-export-field-selection .co-export-field-header .co-export-field-header-selected-count-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:end;color:#475867;font-size:14px;line-height:20px}.co-export-content .co-export-field-selection .co-export-field-content{width:100%;height:auto;padding-inline:0;padding-block:24px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:16px;border-radius:4px;border:1px solid #cfd7df}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header{width:100%;height:32px;padding-inline:24px;padding-block:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header .co-export-field-select-all-label{display:inline-block;font-weight:500;margin:0}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header .co-export-field-search{width:50%}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields{width:100%;height:auto;padding-inline:24px;padding-block:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;gap:32px;overflow-y:auto;max-height:calc( 100vh - 56px - 56px - 20px - 24px - 58px - 24px - 22px - 20px - 10px - 32px - 52px - 32px - 16px )}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-empty-search-message{width:100%;margin-inline:0;margin-block:16px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:center;color:#12344d;font-size:14px;font-weight:400;line-height:24px}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column1{width:calc(50% - 32px);height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:10px}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column1--full-width{width:100%}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column2{width:50%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:10px}.co-export-content--without-filter .co-export-field-selection .co-export-field-content .co-export-field-content-fields{max-height:calc( 100vh - 56px - 56px - 20px - 24px - 22px - 20px - 10px - 32px - 52px - 32px - 16px )}.co-export-modal-footer{width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;gap:12px}';export{c as fw_co_export}
var __awaiter=this&&this.__awaiter||function(e,i,t,r){function l(e){return e instanceof t?e:new t((function(i){i(e)}))}return new(t||(t=Promise))((function(t,n){function a(e){try{s(r.next(e))}catch(i){n(i)}}function o(e){try{s(r["throw"](e))}catch(i){n(i)}}function s(e){e.done?t(e.value):l(e.value).then(a,o)}s((r=r.apply(e,i||[])).next())}))};var __generator=this&&this.__generator||function(e,i){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},r,l,n,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(e){return function(i){return s([e,i])}}function s(a){if(r)throw new TypeError("Generator is already executing.");while(t)try{if(r=1,l&&(n=a[0]&2?l["return"]:a[0]?l["throw"]||((n=l["return"])&&n.call(l),0):l.next)&&!(n=n.call(l,a[1])).done)return n;if(l=0,n)a=[a[0]&2,n.value];switch(a[0]){case 0:case 1:n=a;break;case 4:t.label++;return{value:a[1],done:false};case 5:t.label++;l=a[1];a=[0];continue;case 7:a=t.ops.pop();t.trys.pop();continue;default:if(!(n=t.trys,n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){t=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){t.label=a[1];break}if(a[0]===6&&t.label<n[1]){t.label=n[1];n=a;break}if(n&&t.label<n[2]){t.label=n[2];t.ops.push(a);break}if(n[2])t.ops.pop();t.trys.pop();continue}a=i.call(e,t)}catch(o){a=[6,o];l=0}finally{r=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArray=this&&this.__spreadArray||function(e,i,t){if(t||arguments.length===2)for(var r=0,l=i.length,n;r<l;r++){if(n||!(r in i)){if(!n)n=Array.prototype.slice.call(i,0,r);n[r]=i[r]}}return e.concat(n||Array.prototype.slice.call(i))};import{r as registerInstance,c as createEvent,h,F as Fragment,i as Host,g as getElement}from"./index-f435cf58.js";import{i as i18nText,d as deepCloneObject,g as getFieldTypeCheckboxes,a as getMappedCustomFieldType,b as getMaximumLimitsConfig,h as hasPermission,c as isPrimaryFieldType,e as getDefaultDependentLevels,f as hasCustomProperty,j as isUniqueField,k as formMapper}from"./form-builder-utils-21bc18f0.js";import{p as presetSchema}from"./form-builder-preset-de47aadf.js";import{d as debounce}from"./utils-06a7316a.js";import"./Translation-7ee0e3b3.js";import"./index-fb937839.js";var formBuilderCss=':host{font-family:var(--fw-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", roboto, oxygen, ubuntu, cantarell, "Open Sans", "Helvetica Neue", sans-serif);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{display:inline-block;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.form-builder{width:100%;height:100%;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;background-color:#fff;overflow:hidden;position:relative;--fw-warning-color:#f48928}.form-builder .form-builder-left-panel{height:100%;width:30%;min-width:200px;max-width:350px;padding-inline:20px;padding-block:24px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow-y:auto;background:#f5f7f9;-webkit-border-end:1px solid #ebeff3;border-inline-end:1px solid #ebeff3}.form-builder .form-builder-left-panel .form-builder-left-panel-header{width:100%;height:auto;margin:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.form-builder .form-builder-left-panel .form-builder-left-panel-product-header-label{width:100%;margin:0;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-size:20px;font-weight:700;line-height:28px;height:28px}.form-builder .form-builder-left-panel .form-builder-left-panel-header-label{width:100%;margin:0;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-size:18px;font-weight:700;line-height:28px;height:28px}.form-builder .form-builder-left-panel .form-builder-left-panel-header-desc{width:100%;margin:0;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#475867;font-size:12px;font-weight:400;line-height:18px}.form-builder .form-builder-left-panel .form-builder-left-panel-sub-header-description{width:100%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-padding-after:0;padding-block-end:0;padding-inline:2px;-webkit-padding-before:2px;padding-block-start:2px;-webkit-margin-after:8px;margin-block-end:8px}.form-builder .form-builder-left-panel .form-builder-left-panel-sub-header-description .form-builder-left-panel-sub-header-description-label{width:100%;-webkit-margin-after:0;margin-block-end:0;margin-inline:0;-webkit-margin-before:-2px;margin-block-start:-2px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#475867;font-size:14px;font-weight:400;line-height:18px}.form-builder .form-builder-left-panel .form-builder-left-panel-sub-header-description .form-builder-left-panel-sub-header-description-link-anchor{-webkit-margin-start:0px;margin-inline-start:0px;-webkit-margin-after:0;margin-block-end:0;-webkit-margin-end:0;margin-inline-end:0;-webkit-margin-before:-2px;margin-block-start:-2px;text-align:start;display:inline-block;font-size:14px;color:#2c5cc5;font-weight:400;text-decoration:none;word-wrap:break-word;word-break:break-word;white-space:normal}.form-builder .form-builder-left-panel .form-builder-left-panel-header-desc-wo-header{width:100%;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-after:0;margin-block-end:0;-webkit-margin-end:0;margin-inline-end:0;-webkit-margin-before:16px;margin-block-start:16px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-size:16px;font-weight:600;line-height:24px;height:24px}.form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div{width:calc(100% + 40px);height:calc(100% + 40px);padding-inline:20px;padding-block:40px;position:absolute;inset-inline-start:-20px;inset-block-end:-4px;z-index:2;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:end;justify-content:flex-end}:host(:not([dir="rtl"])) .form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div,:host([dir="ltr"]) .form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div{background-image:-webkit-gradient(linear, left top, left bottom, color-stop(35%, rgba(245, 247, 249, 0.6)), color-stop(40%, rgba(245, 247, 249, 0.93)), to(#f5f7f9));background-image:linear-gradient(180deg, rgba(245, 247, 249, 0.6) 35%, rgba(245, 247, 249, 0.93) 40% 60%, #f5f7f9 100%)}:host([dir="rtl"]) .form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div{background-image:-webkit-gradient(linear, left top, left bottom, color-stop(35%, rgba(245, 247, 249, 0.6)), color-stop(40%, rgba(245, 247, 249, 0.93)), to(#f5f7f9));background-image:linear-gradient(-180deg, rgba(245, 247, 249, 0.6) 35%, rgba(245, 247, 249, 0.93) 40% 60%, #f5f7f9 100%)}.form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div .form-builder-left-panel-list-disabled-header{width:100%;-webkit-margin-after:0;margin-block-end:0;margin-inline:0;-webkit-margin-before:24px;margin-block-start:24px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-size:16px;font-weight:600;line-height:24px}.form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div .form-builder-left-panel-list-disabled-message{width:100%;-webkit-margin-after:0;margin-block-end:0;margin-inline:0;-webkit-margin-before:4px;margin-block-start:4px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#7b8e9f;font-size:14px;font-weight:400;line-height:20px}.form-builder .form-builder-left-panel .form-builder-left-panel-list-disabled-div .form-builder-left-panel-list-disabled-button{-webkit-margin-before:20px;margin-block-start:20px;width:-webkit-max-content;width:-moz-max-content;width:max-content}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container{width:100%;height:auto;-webkit-margin-before:16px;margin-block-start:16px;-webkit-box-sizing:border-box;box-sizing:border-box;position:relative}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list{width:100%;height:auto;gap:10px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list .field-type-menu-description{width:100%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-padding-after:0;padding-block-end:0;padding-inline:2px;-webkit-padding-before:2px;padding-block-start:2px}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list .field-type-menu-description .field-type-menu-description-label{width:100%;-webkit-margin-after:0;margin-block-end:0;margin-inline:0;-webkit-margin-before:-2px;margin-block-start:-2px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#475867;font-size:12px;font-weight:400}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list .field-type-menu-description .field-type-menu-description-link-anchor{-webkit-margin-start:4px;margin-inline-start:4px;-webkit-margin-after:0;margin-block-end:0;-webkit-margin-end:0;margin-inline-end:0;-webkit-margin-before:-2px;margin-block-start:-2px;text-align:start;display:inline-block;font-size:12px;color:#2c5cc5;font-weight:400;text-decoration:none;word-wrap:break-word;word-break:break-word;white-space:normal}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list .field-type-menu-description .field-type-menu-help-fw-icon{-webkit-margin-start:4px;margin-inline-start:4px;vertical-align:middle}.form-builder .form-builder-left-panel .form-builder-left-panel-list-container .form-builder-left-panel-field-types-list .field-type-menu-item-bottom-border{width:100%;height:1px;-webkit-margin-before:2px;margin-block-start:2px;border-width:0;background-color:#cfd7df}.form-builder .form-builder-left-panel--disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:not-allowed;opacity:0.6}.form-builder .form-builder-right-panel{width:70%;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:stretch;align-items:stretch;background:#fff}.form-builder .form-builder-right-panel .form-builder-right-panel-header{width:100%;height:64px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-webkit-margin-after:20px;margin-block-end:20px;-webkit-padding-start:32px;padding-inline-start:32px;-webkit-padding-end:32px;padding-inline-end:32px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content{width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;max-width:990px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-label{width:auto;margin:0;-webkit-margin-start:2px;margin-inline-start:2px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-size:16px;font-weight:700;line-height:28px;height:28px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-right-filter-by-div{width:40%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;gap:4px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-right-filter-by-div .form-builder-right-panel-header-filter-label{width:auto;margin:0;-webkit-margin-start:2px;margin-inline-start:2px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#92a2b1;font-size:14px;font-weight:400;line-height:20px;height:20px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-right-filter-by-div .form-builder-filter-by-field-type-select{width:230px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-right-div{width:80%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:end;justify-content:flex-end;gap:20px}.form-builder .form-builder-right-panel .form-builder-right-panel-header .form-builder-right-panel-header-content .form-builder-right-panel-header-right-div .form-builder-right-panel-header-search-input{max-width:344px;width:calc(100% - 250px)}.form-builder .form-builder-right-panel .form-builder-right-panel-header--disabled{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:not-allowed;opacity:0.6}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container{width:100%;height:calc(100% - 64px - 20px);padding-block:4px 32px;padding-inline:32px 32px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:auto}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-empty-list-div{width:100%;height:100%;-webkit-padding-before:60px;padding-block-start:60px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start;-ms-flex-pack:center;justify-content:center}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-empty-list-div .form-builder-right-panel-empty-list-content{width:100%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;-ms-flex-direction:column;flex-direction:column}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-empty-list-div .form-builder-right-panel-empty-list-content .form-builder-right-panel-empty-list-image-span{width:86px;height:86px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background-color:#eff2fd;border-radius:50%}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-empty-list-div .form-builder-right-panel-empty-list-content .form-builder-right-panel-empty-list-image-span .form-builder-right-panel-empty-list-image{max-width:85%;max-height:85%;-o-object-fit:contain;object-fit:contain;pointer-events:none}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-empty-list-div .form-builder-right-panel-empty-list-content .form-builder-right-panel-empty-search-message{width:100%;margin-inline:0;margin-block:16px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:center;color:#12344d;font-size:18px;font-weight:700;line-height:24px}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container .form-builder-right-panel-field-editor-list{width:100%;min-height:100%;height:auto;gap:10px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center}.form-builder .form-builder-right-panel .form-builder-right-panel-list-container--reordering .form-builder-right-panel-field-editor-list fw-field-editor::part(delete-field-btn){-webkit-transition:none !important;transition:none !important;opacity:0 !important}.cusomize-widget-list{width:100%;min-height:100%;height:auto;gap:10px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox !important;display:flex !important;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center}.cusomize-widget-header{width:100%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.cusomize-widget-header .cusomize-widget-title{font-size:18px;font-weight:600;line-height:24px}.cusomize-widget-header .cusomize-widget-description{font-size:14px;font-weight:400;color:#475867;line-height:20px;padding-inline:0px;padding-block:6px}.cusomize-widget-modal-footer{width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;gap:12px}';var FormBuilder=function(){function e(e){var i=this;registerInstance(this,e);this.fwSaveField=createEvent(this,"fwSaveField",7);this.fwDeleteField=createEvent(this,"fwDeleteField",7);this.fwComposeNewField=createEvent(this,"fwComposeNewField",7);this.fwRepositionField=createEvent(this,"fwRepositionField",7);this.fwExpandField=createEvent(this,"fwExpandField",7);this.fwExplorePlan=createEvent(this,"fwExplorePlan",7);this.fwSearchField=createEvent(this,"fwSearchField",7);this.fwSaveWidgetFields=createEvent(this,"fwSaveWidgetFields",7);this.isWidgetValuesChanged=false;this.filterByFieldTypeOptions=null;this.FILTER_ALL_FIELDS="ALL_FIELDS";this.productName="CUSTOM_OBJECTS";this.role="admin";this.permission={view:true,create:true,edit:true,delete:true};this.expandedFieldIndex=-1;this.formValues=null;this.lookupTargetObjects=null;this.showLookupField=true;this.showDependentField=true;this.customizeWidgetFields=null;this.isLoading=false;this.isSavingCustomizeWidget=false;this.userPlan="admin";this.emptySearchImage=null;this.localFormValues=null;this.arrWidgetFields=null;this.arrSearchedFields=null;this.arrFilteredByTypeFields=null;this.searching=false;this.showCustomizeWidget=false;this.fieldTypesCount=null;this.enableFieldType=true;this.enableFilterable=true;this.enableUnique=true;this.selectedFieldTypeFilterOption=this.FILTER_ALL_FIELDS;this.fieldRerenderCount=0;this.getInterpolatedMaxLimitLabel=function(e){var t;if(e&&e!==""){try{var r=(t=getMaximumLimitsConfig(i.productName))===null||t===void 0?void 0:t[e];if(r){return i18nText(r.message,{count:r.count})}}catch(l){return""}}return""};this.getDefaultFieldTypeSchema=function(e){if(presetSchema){try{var t=presetSchema.fieldTypes[e];if(t){var r=deepCloneObject(t);r.checkboxes=getFieldTypeCheckboxes(i.productName,e);return r}else{console.log("".concat(e," - field type is not supported"))}}catch(l){console.log("".concat(e," - field type is not supported"))}}return null};this.removeFieldReorderClass=function(){try{if(i.fieldEditorPanel){i.fieldEditorPanel.classList.remove("form-builder-right-panel-list-container--reordering")}}catch(e){console.error("Could not remove dragged class")}};this.reorderFieldProgressHandler=function(e){if(i.fieldEditorPanel){var t=e.detail.value;if(t){i.fieldEditorPanel.classList.add("form-builder-right-panel-list-container--reordering")}else{i.removeFieldReorderClass()}}};this.expandFieldHandler=function(e){i.fwExpandField.emit(Object.assign({},e.detail))};this.explorePlanHandler=function(e){i.fwExplorePlan.emit(Object.assign({},e.detail))};this.saveFieldHandler=function(e){var t=Object.assign({},e.detail);var r=t.value;r.type=getMappedCustomFieldType(i.productName,r.type);i.fwSaveField.emit(t)};this.deleteFieldHandler=function(e){i.fwDeleteField.emit(Object.assign({},e.detail))};this.composeNewField=function(e,t,r){if(r===void 0){r=-1}var l;var n=e;var a=deepCloneObject(presetSchema.fieldTypes[n]);var o=getMaximumLimitsConfig(i.productName);try{var s=(l=i.localFormValues)===null||l===void 0?void 0:l.fields;a.checkboxes=getFieldTypeCheckboxes(i.productName,a.type);if(a.type!=="RELATIONSHIP"&&a.checkboxes&&a.checkboxes.length>0&&o){var d=s.filter((function(e){return(e===null||e===void 0?void 0:e.filterable)===true||(e===null||e===void 0?void 0:e.filterable)==="true"}));var f=o.filterable.count;if(d.length>=f){var p=a.checkboxes;var u=p.length;for(var c=0;c<u;c++){if(p[c].key==="filterable"){p[c].selected=false;break}}}}}catch(h){console.error("Error occurred in composeNewField: ".concat(h))}a.type=getMappedCustomFieldType(i.productName,a.type);i.fwComposeNewField.emit({maximumLimits:getMaximumLimitsConfig(i.productName),fieldSchema:a,value:Object.assign({},t),index:r})};this.fieldTypeDropHandler=function(e){i.removeFieldReorderClass();var t=e.detail;var r=t.droppedElement;var l=t.droppedIndex;if(t.dragFromId!==t.dropToId){var n=hasPermission(i.role,i.permission,"CREATE");if(!n){return}i.composeNewField(r.dataProvider.type,Object.assign({},r.dataProvider),l)}else{if(r.index!==l){i.fwRepositionField.emit({sourceIndex:r.index,targetIndex:l})}}};this.removeResizeObserver=function(){if(i.resizeObserver){i.resizeObserver.disconnect();i.resizeObserver=null}};this.addNewFieldTypeHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();var t=hasPermission(i.role,i.permission,"CREATE");if(!t){return}i.resizeObserver=new ResizeObserver((function(){i.removeResizeObserver();setTimeout((function(){i.fieldEditorPanel.scrollTop=i.fieldEditorPanel.scrollHeight}),100)}));i.resizeObserver.observe(i.fieldEditorPanel);i.composeNewField(e.detail.value,Object.assign({},e.detail.data))};this.initializeSearchDebounce=function(){if(!i.debouncedHandleInput){i.debouncedHandleInput=debounce(i.searchChangeHandler,i)}};this.searchChangeHandler=function(e){var t,r;e.stopImmediatePropagation();e.stopPropagation();var l=((r=(t=e===null||e===void 0?void 0:e.detail)===null||t===void 0?void 0:t.value)===null||r===void 0?void 0:r.trim())||"";if(l){var n=i.localFormValues&&i.localFormValues.fields?i.localFormValues.fields:[];if(n&&n.length>0){var a=l.toLowerCase();var o=n.filter((function(e){return e.label.toLowerCase().indexOf(a)!==-1}));i.searching=true;i.arrSearchedFields=deepCloneObject(o);return}}i.searching=false;i.arrSearchedFields=null};this.clearSearchHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();i.arrSearchedFields=null;i.searching=false};this.fieldTypeFilterChangeHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();var t=e.detail.value;if(t&&t!==""&&t!==i.FILTER_ALL_FIELDS){i.arrSearchedFields=null;i.searching=false;var r=i.localFormValues&&i.localFormValues.fields?i.localFormValues.fields:[];if(r&&r.length>0){var l=r.filter((function(e){return e.type.indexOf(t)!==-1}));i.arrFilteredByTypeFields=deepCloneObject(l);i.selectedFieldTypeFilterOption=t;return}}i.arrFilteredByTypeFields=null;i.selectedFieldTypeFilterOption=i.FILTER_ALL_FIELDS};this.openCustomizeWidgetModalHandler=function(e){var t,r;e.stopImmediatePropagation();e.stopPropagation();if(!i.localFormValues||!i.localFormValues.fields||i.localFormValues.fields.length<=0){return}var l=i.localFormValues.fields;var n=i.customizeWidgetFields?__spreadArray([],i.customizeWidgetFields,true):[];var a=[];if((n===null||n===void 0?void 0:n.length)>1){i.isWidgetValuesChanged=false;var o=n.length;for(var s=0;s<o;s++){a=__spreadArray(__spreadArray([],a,true),[n[s]],false)}}else{if(n&&n.length===1&&isPrimaryFieldType(n[0],i.productName)){a=__spreadArray(__spreadArray([],a,true),[n[0]],false)}var d=getMaximumLimitsConfig(i.productName);var f=((t=d===null||d===void 0?void 0:d.widgets)===null||t===void 0?void 0:t.count)||0;var p=l.length;for(var u=0;u<p;u++){if(!a.includes(l[u].id)){a=__spreadArray(__spreadArray([],a,true),[l[u].id],false)}if(a.length===f){break}}i.isWidgetValuesChanged=true}i.arrWidgetFields=__spreadArray([],a,true);i.showCustomizeWidget=true;(r=i.modalCustomizeWidget)===null||r===void 0?void 0:r.open()};this.saveWidgetDetailsHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();if(i.isWidgetValuesChanged){i.isSavingCustomizeWidget=true;i.fwSaveWidgetFields.emit(__spreadArray([],i.arrWidgetFields,true))}};this.closeWidgetDetailsHandler=function(e){if(e===void 0){e=null}var t;if(e){e.stopImmediatePropagation();e.stopPropagation()}(t=i.modalCustomizeWidget)===null||t===void 0?void 0:t.close();i.isWidgetValuesChanged=false;i.showCustomizeWidget=false;i.arrWidgetFields=null};this.widgetCheckHandler=function(e){var t;e.stopImmediatePropagation();e.stopPropagation();var r=e.detail.checked;if(i.arrWidgetFields){var l=e.detail.data.id;var n=getMaximumLimitsConfig(i.productName);var a=((t=n===null||n===void 0?void 0:n.widgets)===null||t===void 0?void 0:t.count)||0;if(r&&i.arrWidgetFields.length<a){i.isWidgetValuesChanged=true;i.arrWidgetFields=__spreadArray(__spreadArray([],i.arrWidgetFields,true),[l],false)}else if(i.arrWidgetFields.includes(l)){i.isWidgetValuesChanged=true;var o=i.arrWidgetFields.indexOf(l);i.arrWidgetFields=__spreadArray(__spreadArray([],i.arrWidgetFields.slice(0,o),true),i.arrWidgetFields.slice(o+1),true)}}}}e.prototype.watchSearchHandler=function(){this.fwSearchField.emit({searching:this.searching})};e.prototype.watchSaveCustomizeWidgetChangeHandler=function(){if(!this.isSavingCustomizeWidget){this.closeWidgetDetailsHandler()}};e.prototype.watchFormValuesChangeHandler=function(e){this.validateFormValues(e)};e.prototype.watchProductNameChangeHandler=function(){this.validateFormValues()};e.prototype.forceRenderFields=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.fieldRerenderCount++;return[2]}))}))};e.prototype.componentWillLoad=function(){this.initializeSearchDebounce();this.validateFormValues();this.supportedFieldTypes=["TEXT","EMAIL","CHECKBOX","PARAGRAPH","NUMBER","DECIMAL","DATE","DROPDOWN","DEPENDENT_FIELD","RELATIONSHIP","MULTI_SELECT"]};e.prototype.disconnectedCallback=function(){this.debouncedHandleInput=null;this.removeResizeObserver()};e.prototype.validateFormValues=function(e){if(e===void 0){e=null}var i,t,r;this.fieldTypesCount=null;var l={filterable:0,unique:0};this.localFormValues=e?deepCloneObject(e):this.formValues?deepCloneObject(this.formValues):null;if(this.localFormValues){var n=(i=this.localFormValues)===null||i===void 0?void 0:i.fields;var a=formMapper[this.productName];var o=a["reverseMappedFieldTypes"];var s=a.config;var d=(s===null||s===void 0?void 0:s.showDefaultTag)&&(s===null||s===void 0?void 0:s.defaultTagKey)&&s.defaultTagKey!==""?true:false;var f=d?s.defaultTagKey:"";if(n&&n.length>0){var p=0;var u=n.length;for(var c=0;c<u;c++){if(((r=(t=n[c])===null||t===void 0?void 0:t.field_options)===null||r===void 0?void 0:r.dependent)==="true"){var h=s.internalNamePrefix;n[c]=getDefaultDependentLevels({type:"22",label:n[c].label,name:n[c].name,fields:[n[c]]},h)}var m=n[c];if(!m){continue}if(o){if(hasCustomProperty(o,m.type)){m.type=o[m.type]}else{console.log("".concat(m.type," is not added in the mapper - Unsupported field type"))}}var b=m.type;if(!(m===null||m===void 0?void 0:m.isNew)){if(b!=="RELATIONSHIP"&&((m===null||m===void 0?void 0:m.filterable)===true||(m===null||m===void 0?void 0:m.filterable)==="true")){l.filterable++}if(isUniqueField(m)){l.unique++}if(!this.fieldTypesCount){this.fieldTypesCount={}}var g=b==="PRIMARY"?"TEXT":b;if(!hasCustomProperty(this.fieldTypesCount,g)){this.fieldTypesCount[g]=0}this.fieldTypesCount[g]++}if(!d){p++}else if(f&&f!==""&&hasCustomProperty(m,f)&&m[f]){p++}}var x=getMaximumLimitsConfig(this.productName);this.enableFieldType=p<x.fields.count;this.enableFilterable=l.filterable<x.filterable.count;this.enableUnique=l.unique<x.unique.count}else{this.enableUnique=true;this.enableFilterable=true;this.enableFieldType=true;this.fieldTypesCount=null}}};e.prototype.renderFieldTypesHeader=function(e){var i="form-builder";var t=e.labels;var r=hasCustomProperty(t,"headerProduct")?t.headerProduct:"";var l=hasCustomProperty(t,"subHeaderProduct")?t.subHeaderProduct:"";var n=hasCustomProperty(t,"subHeaderProductLink")?t.subHeaderProductLink:null;var a=n?i18nText(n.label):"";var o=n?n.href:"";var s=a&&a!==""?true:false;var d=hasCustomProperty(t,"fieldTypesHeader")?t.fieldTypesHeader:"";var f=hasCustomProperty(t,"dragDropFieldTypes")?t.dragDropFieldTypes:"";var p=d&&d!==""?true:false;var u=p?"".concat(i,"-left-panel-header-desc"):"".concat(i,"-left-panel-header-desc-wo-header");return h("div",{class:"".concat(i,"-left-panel-header")},r&&r!==""&&h("label",{class:"".concat(i,"-left-panel-product-header-label")},i18nText(r)),l&&l!==""&&h("span",{class:"form-builder-left-panel-sub-header-description"},h("label",{class:"form-builder-left-panel-sub-header-description-label"},i18nText(l)),s&&h("a",{class:"form-builder-left-panel-sub-header-description-link-anchor",href:o,target:"_blank"},a)),p&&h("label",{class:"".concat(i,"-left-panel-header-label")},i18nText(d)),f&&f!==""&&h("label",{class:u},i18nText(f)))};e.prototype.renderDisableFieldCreateByRole=function(e,i){if(this.role==="trial"){return h("div",{class:"".concat(i,"-left-panel-list-disabled-div")},h("fw-icon",{name:"lock",size:"30"}),h("label",{class:"".concat(i,"-left-panel-list-disabled-header")},i18nText(e===null||e===void 0?void 0:e.freePlanFieldAddDisabledHeader)),h("label",{class:"".concat(i,"-left-panel-list-disabled-message")},i18nText(e===null||e===void 0?void 0:e.freePlanFieldAddDisabledMessage)),h("fw-button",{color:"primary",onFwClick:this.explorePlanHandler,class:"".concat(i,"-left-panel-list-disabled-button")},i18nText(e===null||e===void 0?void 0:e.freePlanFieldAddDisabledButton)))}};e.prototype.renderDisableFieldCreateByPermission=function(e,i){var t=hasPermission(this.role,this.permission,"CREATE");if(!t&&this.role!=="trial"){return h("div",{class:"".concat(i,"-left-panel-list-disabled-div")},h("fw-icon",{name:"lock",size:"30"}),h("label",{class:"".concat(i,"-left-panel-list-disabled-header")},i18nText(e===null||e===void 0?void 0:e.noCreatePermissionFieldAddDisabledHeader)),h("label",{class:"".concat(i,"-left-panel-list-disabled-message")},i18nText(e===null||e===void 0?void 0:e.noCreatePermissionFieldAddDisabledMessage)))}};e.prototype.renderFieldTypeElement=function(e,i,t,r){if(e==="PRIMARY"){return null}var l=t===null||t===void 0?void 0:t.fieldProps[e];var n=i[e];var a=n.type;if(!this.supportedFieldTypes.includes(a)){return null}var o=!this.enableFieldType;var s=o?this.getInterpolatedMaxLimitLabel("fields"):"";var d=getMaximumLimitsConfig(this.productName);if(!o&&hasCustomProperty(this.fieldTypesCount,a)&&this.fieldTypesCount[a]>0&&hasCustomProperty(d,a)&&this.fieldTypesCount[a]>=d[a].count){o=true;s=o?this.getInterpolatedMaxLimitLabel(a):""}var f=hasCustomProperty(l,"display_label")?l.display_label:"";var p=hasCustomProperty(l,"description")?i18nText(l.description):"";var u=p&&p!==""?true:false;var c=hasCustomProperty(l,"help")?i18nText(l.help):"";var m=c&&c!==""?true:false;var b=hasCustomProperty(l,"link")?l.link:null;var g=b?i18nText(b.label):"";var x=b?b.href:"";var v=g&&g!==""?true:false;var y=hasCustomProperty(l,"has_bottom_border")?l.has_bottom_border:false;return h(Fragment,null,h("fw-field-type-menu-item",{index:r,key:a,value:a,dataProvider:n,tooltip:s,disabled:o,label:f,iconName:n.icon.name,iconBackgroundColor:n.icon.bg_color,onFwAddClick:this.addNewFieldTypeHandler}),u&&h("span",{class:"field-type-menu-description"},h("label",{class:"field-type-menu-description-label"},p),v&&h("a",{class:"field-type-menu-description-link-anchor",href:x,target:"_blank"},g),m&&h("fw-tooltip",{placement:"right",trigger:"hover",content:c},h("fw-icon",{class:"field-type-menu-help-fw-icon",size:14,name:"help",color:"#12344d"}))),y&&h("hr",{class:"field-type-menu-item-bottom-border"}))};e.prototype.renderFieldEditorElement=function(e,i,t,r){if(!e){return null}var l=e.type;var n=this.getDefaultFieldTypeSchema(l);if(!n){return null}var a=isPrimaryFieldType(e,this.productName,i,!this.searching);var o=this.expandedFieldIndex===i?true:false;var s="".concat(e.id,"_").concat(i.toString());return h("fw-field-editor",{index:i,key:s,productName:this.productName,dataProvider:e,entityName:r,expanded:o,isPrimaryField:a,pinned:a?"top":"",disabled:t,disabledSort:this.searching,permission:this.permission,role:this.role,enableUnique:this.enableUnique,enableFilterable:this.enableFilterable,defaultFieldTypeSchema:n,lookupTargetObjects:this.lookupTargetObjects,formValues:this.localFormValues,isLoading:this.isLoading,onFwUpdate:this.saveFieldHandler,onFwDelete:this.deleteFieldHandler,onFwExpand:this.expandFieldHandler,onFwReorder:this.reorderFieldProgressHandler})};e.prototype.renderWidgetElement=function(e,i){var t,r;var l=getMaximumLimitsConfig(this.productName);var n=((t=l===null||l===void 0?void 0:l.widgets)===null||t===void 0?void 0:t.count)||0;var a=isPrimaryFieldType(e,this.productName,i);var o=!a?((r=this.arrWidgetFields)===null||r===void 0?void 0:r.includes(e.id))?true:false:true;var s=a?true:!o?this.arrWidgetFields.length>=n:false;return h("fw-widget-customize-field-item",{index:i,key:e.id,label:e.label,dataProvider:e,isPrimaryField:a,pinned:a?"top":"",selected:o,disabled:s,onFwCheck:this.widgetCheckHandler})};e.prototype.render=function(){var e=this;var i="form-builder";var t=this.localFormValues;var r=presetSchema.fieldTypes;var l=formMapper[this.productName];var n=l===null||l===void 0?void 0:l.config;var a=l===null||l===void 0?void 0:l.labels;var o=l===null||l===void 0?void 0:l.fieldOrder;if(!this.showLookupField){var s=o.indexOf("RELATIONSHIP");if(s>-1){o.splice(s,1)}}if(!this.showDependentField){var d=o.indexOf("DEPENDENT_FIELD");if(d>-1){o.splice(d,1)}}var f=this.expandedFieldIndex>-1?true:false;var p=t?t.name:"";var u=hasCustomProperty(a,"fieldsHeader")?a.fieldsHeader:"";var c=o&&o.length>0?o.map((function(i,t){return e.renderFieldTypeElement(i,r,l,t)})):null;var m=this.selectedFieldTypeFilterOption&&this.selectedFieldTypeFilterOption!==""&&this.selectedFieldTypeFilterOption!==this.FILTER_ALL_FIELDS?true:false;var b=m?this.arrFilteredByTypeFields:this.searching?this.arrSearchedFields:t&&t.fields?t.fields:[];var g=b&&b.length>0?b.map((function(i,t){return e.renderFieldEditorElement(i,t,f,p)})):null;var x=this.searching&&(!g||g.length===0)||m&&(!g||g.length===0);var v=(n===null||n===void 0?void 0:n.customizeWidget)||false;var y=this.showCustomizeWidget&&b&&b.length>0?b.map((function(i,t){return e.renderWidgetElement(i,t)})):null;var w=(n===null||n===void 0?void 0:n.filterByType)||false;if(!this.filterByFieldTypeOptions&&o&&o.length>0){var F=l===null||l===void 0?void 0:l.fieldProps;var k=o.length;this.filterByFieldTypeOptions=[{text:i18nText("filterOptionAllFields"),value:this.FILTER_ALL_FIELDS}];for(var z=0;z<k;z++){this.filterByFieldTypeOptions.push({text:i18nText(F[o[z]].display_label),value:o[z]})}}var T="".concat(i,"-right-panel");var C="".concat(i,"-left-panel");var P="".concat(T,"-header");var E=C;if(f||this.searching){E+=" ".concat(C,"--disabled")}if(f){P+=" ".concat(T,"-header--disabled")}return h(Host,{tabIndex:"-1"},h("div",{class:i},h("div",{class:E},this.renderFieldTypesHeader(l),h("div",{class:"".concat(i,"-left-panel-list-container")},h("fw-drag-container",{class:"".concat(i,"-left-panel-field-types-list"),id:"fieldTypesList",addOnDrop:false,sortable:false},c),this.renderDisableFieldCreateByRole(n,i),this.renderDisableFieldCreateByPermission(n,i))),h("div",{class:T},h("div",{class:P},h("div",{class:"".concat(i,"-right-panel-header-content")},!w&&h("label",{class:"".concat(i,"-right-panel-header-label")},i18nText(u)),w&&h("div",{class:"".concat(i,"-right-panel-header-right-filter-by-div")},h("label",{class:"".concat(i,"-right-panel-header-filter-label")},i18nText("filterFields")),h("fw-select",{class:"".concat(i,"-filter-by-field-type-select"),options:this.filterByFieldTypeOptions,value:this.selectedFieldTypeFilterOption,onFwChange:this.fieldTypeFilterChangeHandler})),h("div",{class:"".concat(i,"-right-panel-header-right-div")},v&&h("fw-button",{id:"customizeWidgetFieldsBtn",color:"link",disabled:this.searching,onFwClick:this.openCustomizeWidgetModalHandler},h("fw-icon",{name:"modify",slot:"before-label"}),i18nText("customizeWidget")),h("fw-input",{"clear-input":true,"icon-left":"search",placeholder:i18nText("searchFields"),onFwInput:this.debouncedHandleInput,onFwInputClear:this.clearSearchHandler,class:"".concat(i,"-right-panel-header-search-input")})))),h("div",{ref:function(i){return e.fieldEditorPanel=i},class:"".concat(i,"-right-panel-list-container")},!x&&h("fw-drag-container",{key:"field-drag-container-".concat(this.fieldRerenderCount.toString()),class:"".concat(i,"-right-panel-field-editor-list"),id:"fieldsContainer",acceptFrom:"fieldTypesList",addOnDrop:false,sortable:true,onFwDrop:this.fieldTypeDropHandler},g),x&&h("div",{class:"".concat(i,"-right-panel-empty-list-div")},h("div",{class:"".concat(i,"-right-panel-empty-list-content")},h("span",{class:"".concat(i,"-right-panel-empty-list-image-span")},h("img",{alt:"",src:this.emptySearchImage,class:"".concat(i,"-right-panel-empty-list-image")})),h("label",{class:"".concat(i,"-right-panel-empty-search-message")},i18nText("noSearchItemsFound"))))))),h("fw-modal",{ref:function(i){return e.modalCustomizeWidget=i},size:"small",hasCloseIconButton:false},h("fw-modal-title",null,h("span",{class:"cusomize-widget-header"},h("span",{class:"cusomize-widget-title"},i18nText("customizeWidgetModalHeader")),h("span",{class:"cusomize-widget-description"},i18nText("customizeWidgetModalHint")))),h("fw-modal-content",null,this.showCustomizeWidget&&h("fw-drag-container",{class:"cusomize-widget-list",id:"customizeWidgetList",addOnDrop:false,sortable:false},y)),h("fw-modal-footer",null,h("span",{class:"cusomize-widget-modal-footer"},h("fw-button",{color:"secondary",onFwClick:this.closeWidgetDetailsHandler},i18nText("customizeWidgetModalCancelBtn")),h("fw-button",{loading:this.isSavingCustomizeWidget,onFwClick:this.saveWidgetDetailsHandler},i18nText("customizeWidgetModalSaveBtn"))))))};Object.defineProperty(e.prototype,"host",{get:function(){return getElement(this)},enumerable:false,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{searching:["watchSearchHandler"],isSavingCustomizeWidget:["watchSaveCustomizeWidgetChangeHandler"],formValues:["watchFormValuesChangeHandler"],productName:["watchProductNameChangeHandler"]}},enumerable:false,configurable:true});return e}();FormBuilder.style=formBuilderCss;export{FormBuilder as fw_form_builder};
var __awaiter=this&&this.__awaiter||function(e,t,o,i){function l(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,n){function r(e){try{s(i.next(e))}catch(t){n(t)}}function a(e){try{s(i["throw"](e))}catch(t){n(t)}}function s(e){e.done?o(e.value):l(e.value).then(r,a)}s((i=i.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var o={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},i,l,n,r;return r={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return s([e,t])}}function s(r){if(i)throw new TypeError("Generator is already executing.");while(o)try{if(i=1,l&&(n=r[0]&2?l["return"]:r[0]?l["throw"]||((n=l["return"])&&n.call(l),0):l.next)&&!(n=n.call(l,r[1])).done)return n;if(l=0,n)r=[r[0]&2,n.value];switch(r[0]){case 0:case 1:n=r;break;case 4:o.label++;return{value:r[1],done:false};case 5:o.label++;l=r[1];r=[0];continue;case 7:r=o.ops.pop();o.trys.pop();continue;default:if(!(n=o.trys,n=n.length>0&&n[n.length-1])&&(r[0]===6||r[0]===2)){o=0;continue}if(r[0]===3&&(!n||r[1]>n[0]&&r[1]<n[3])){o.label=r[1];break}if(r[0]===6&&o.label<n[1]){o.label=n[1];n=r;break}if(n&&o.label<n[2]){o.label=n[2];o.ops.push(r);break}if(n[2])o.ops.pop();o.trys.pop();continue}r=t.call(e,o)}catch(a){r=[6,a];l=0}finally{i=n=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:true}}};import{r as registerInstance,c as createEvent,h,g as getElement}from"./index-f435cf58.js";import{T as TranslationController}from"./Translation-7ee0e3b3.js";import{d as debounce}from"./utils-06a7316a.js";import{d as deepCloneObject}from"./form-builder-utils-21bc18f0.js";import"./index-fb937839.js";var coExportCss=':host{font-family:var(--fw-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", roboto, oxygen, ubuntu, cantarell, "Open Sans", "Helvetica Neue", sans-serif);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{display:block;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-modal-content{height:100%;overflow:hidden}.co-export-content{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-padding-before:20px;padding-block-start:20px;gap:24px}.co-export-content .clearExportFilter{font-weight:700;color:#2c5cc5;cursor:pointer}.co-export-content .co-export-format{width:100%;height:auto;display:-ms-flexbox;display:flex;gap:24px;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-content .co-export-format .co-export-format-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#475867;font-size:14px;line-height:20px;margin:0}.co-export-content .co-export-field-selection{width:100%;height:auto;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box;gap:10px}.co-export-content .co-export-field-selection .co-export-field-header{width:100%;height:20px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-sizing:border-box;box-sizing:border-box}.co-export-content .co-export-field-selection .co-export-field-header .co-export-field-header-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:start;color:#12344d;font-weight:600;font-size:14px;line-height:20px}.co-export-content .co-export-field-selection .co-export-field-header .co-export-field-header-selected-count-label{width:auto;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:end;color:#475867;font-size:14px;line-height:20px}.co-export-content .co-export-field-selection .co-export-field-content{width:100%;height:auto;padding-inline:0;padding-block:24px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:16px;border-radius:4px;border:1px solid #cfd7df}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header{width:100%;height:32px;padding-inline:24px;padding-block:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:justify;justify-content:space-between}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header .co-export-field-select-all-label{display:inline-block;font-weight:500;margin:0}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-header .co-export-field-search{width:50%}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields{width:100%;height:auto;padding-inline:24px;padding-block:0;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;gap:32px;overflow-y:auto;max-height:calc( 100vh - 56px - 56px - 20px - 24px - 58px - 24px - 22px - 20px - 10px - 32px - 52px - 32px - 16px )}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-empty-search-message{width:100%;margin-inline:0;margin-block:16px;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:center;color:#12344d;font-size:14px;font-weight:400;line-height:24px}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column1{width:calc(50% - 32px);height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:10px}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column1--full-width{width:100%}.co-export-content .co-export-field-selection .co-export-field-content .co-export-field-content-fields .co-export-field-content-fields-column2{width:50%;height:auto;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:10px}.co-export-content--without-filter .co-export-field-selection .co-export-field-content .co-export-field-content-fields{max-height:calc( 100vh - 56px - 56px - 20px - 24px - 22px - 20px - 10px - 32px - 52px - 32px - 16px )}.co-export-modal-footer{width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-ms-flexbox;display:flex;gap:12px}';var CoExport=function(){function e(e){var t=this;registerInstance(this,e);this.fwExport=createEvent(this,"fwExport",7);this.fwCloseExport=createEvent(this,"fwCloseExport",7);this.SEARCH_COUNT=10;this.boolAddedClearFilterEvent=false;this.allFieldsSelected=false;this.arrSearchedFields=null;this.searching=false;this.searchText="";this.clearFilter=false;this.selectedFieldCount=0;this.isOpen=false;this.value=null;this.resetStates=function(){t.debouncedHandleInput=null;t.arrSearchedFields=null;t.searching=false;t.searchText="";t.allFieldsSelected=false;t.clearFilter=false;t.selectedFieldCount=0;t.value=null};this.initializeSearchDebounce=function(){if(!t.debouncedHandleInput){t.debouncedHandleInput=debounce(t.searchChangeHandler,t)}};this.addClearFilterEvent=function(){if(!t.boolAddedClearFilterEvent){var e=t.host.shadowRoot.querySelector(".clearExportFilter");if(e){t.boolAddedClearFilterEvent=true;e.addEventListener("click",t.clearFiltersHandler)}}};this.clearFiltersHandler=function(e){var o;e.stopImmediatePropagation();e.stopPropagation();if((o=t.value)===null||o===void 0?void 0:o.filter){t.value.filter.value=false}t.clearFilter=true};this.searchChangeHandler=function(e){var o,i,l,n;e.stopImmediatePropagation();e.stopPropagation();var r=((i=(o=e===null||e===void 0?void 0:e.detail)===null||o===void 0?void 0:o.value)===null||i===void 0?void 0:i.trim())||"";t.searchText=r;if(r){if(((n=(l=t.value)===null||l===void 0?void 0:l.fields)===null||n===void 0?void 0:n.length)>0){var a=r.toLowerCase();var s=t.value.fields.filter((function(e){return e.label.toLowerCase().indexOf(a)!==-1}));t.searching=true;t.arrSearchedFields=deepCloneObject(s);return}}t.searching=false;t.arrSearchedFields=null};this.clearSearchHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();t.arrSearchedFields=null;t.searching=false;t.searchText=""};this.selectAllFieldsChangeHandler=function(e){var o,i;e.stopImmediatePropagation();e.stopPropagation();var l=e.detail.meta.checked;t.allFieldsSelected=l;if(t.searching&&t.arrSearchedFields){var n=t.arrSearchedFields.length;for(var r=0;r<n;r++){var a=t.arrSearchedFields[r];if(!Object.prototype.hasOwnProperty.call(a,"disabled")||!a.disabled){t.arrSearchedFields[r]=Object.assign(Object.assign({},a),{selected:l})}}}if(((i=(o=t.value)===null||o===void 0?void 0:o.fields)===null||i===void 0?void 0:i.length)>0){var s=t.value.fields;var c=s.length;for(var r=0;r<c;r++){var a=s[r];if(!Object.prototype.hasOwnProperty.call(a,"disabled")||!a.disabled){s[r]=Object.assign(Object.assign({},a),{selected:l})}}t.updateSelectedCount()}};this.fieldSelectionChangeHandler=function(e){var o,i;e.stopImmediatePropagation();e.stopPropagation();if(((i=(o=t.value)===null||o===void 0?void 0:o.fields)===null||i===void 0?void 0:i.length)>0){var l=e.detail.checked;var n=e.detail.value;var r=t.value.fields.filter((function(e){return Object.prototype.hasOwnProperty.call(e,"id")&&e.id===n}));if(r&&r.length>0){r[0].selected=l;t.updateSelectedCount()}}};this.closeModalHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();t.fwCloseExport.emit()};this.exportHandler=function(e){e.stopImmediatePropagation();e.stopPropagation();t.fwExport.emit({value:deepCloneObject(t.value)})};this.exportFormatChangeHandler=function(e){var o,i;e.stopImmediatePropagation();e.stopPropagation();var l=(o=e===null||e===void 0?void 0:e.detail)===null||o===void 0?void 0:o.value;if(l&&l!==""&&((i=t.value)===null||i===void 0?void 0:i.formats)){t.value.formats.selectedValue=l}}}e.prototype.close=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.resetStates();this.isOpen=false;return[2,true]}))}))};e.prototype.open=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){this.initializeSearchDebounce();this.isOpen=true;return[2,true]}))}))};e.prototype.componentWillLoad=function(){var e,t;var o=((t=(e=this.value)===null||e===void 0?void 0:e.filter)===null||t===void 0?void 0:t.value)||false;this.clearFilter=!o;this.updateSelectedCount();this.initializeSearchDebounce()};e.prototype.componentDidUpdate=function(){this.addClearFilterEvent()};e.prototype.disconnectedCallback=function(){this.resetStates()};e.prototype.updateSelectedCount=function(){var e,t;if(((t=(e=this.value)===null||e===void 0?void 0:e.fields)===null||t===void 0?void 0:t.length)>0){var o=this.value.fields;var i=o.filter((function(e){return Object.prototype.hasOwnProperty.call(e,"selected")&&e.selected===true}));var l=(i===null||i===void 0?void 0:i.length)||0;this.selectedFieldCount=l;this.allFieldsSelected=l===o.length?true:false}else{this.selectedFieldCount=0;this.allFieldsSelected=false}};e.prototype.renderCheckboxField=function(e){var t=this.searching&&this.searchText&&this.searchText!==""?"search_".concat(this.searchText,"_").concat(e.id):"".concat(e.id);return h("fw-co-export-field",{key:t,value:e,onFwChange:this.fieldSelectionChangeHandler})};e.prototype.render=function(){var e=this;var t,o,i;var l=this.isOpen;var n=l?(t=this.value)===null||t===void 0?void 0:t.filter:null;var r=!this.clearFilter&&n?true:false;var a=r?TranslationController.t("export.filterInfo",{filtered:n.filtered,total:n.total}):"";var s=((o=this.value)===null||o===void 0?void 0:o.formats)||null;var c=s?s.selectedValue:"";var d=s?(s===null||s===void 0?void 0:s.options)||null:null;var p=this.searching?this.arrSearchedFields:((i=this.value)===null||i===void 0?void 0:i.fields)||null;var f=p?p.length:0;var x=this.searching||f>this.SEARCH_COUNT;var u=x&&this.searching&&f<=0;var b=f<=this.SEARCH_COUNT?f:Math.ceil(f/2);var v=x?f-b:0;var g=v>0;var m=b>0?p.slice(0,b).map((function(t){return e.renderCheckboxField(t)})):null;var w=g?p.slice(b+1).map((function(t){return e.renderCheckboxField(t)})):null;var y="co-export-content";if(!r){y+=" co-export-content--without-filter"}var C="co-export-field-content-fields-column1";if(!g){C+=" co-export-field-content-fields-column1--full-width"}return h("fw-modal",{isOpen:this.isOpen,slider:true,icon:"download",titleText:TranslationController.t("export.modalTitle"),onFwClose:this.closeModalHandler},h("fw-modal-content",{class:"co-export-modal-content"},h("div",{class:y},r&&h("fw-inline-message",{open:true,type:"info",closable:false},h("span",{innerHTML:a})),h("div",{class:"co-export-format"},h("span",{class:"co-export-format-label"},TranslationController.t("export.exportFormat")),d&&d.length>0&&h("fw-radio-group",{orientation:"row",value:c,onFwChange:this.exportFormatChangeHandler},d.map((function(e){return h("fw-radio",{value:e.value},e.label)})))),h("div",{class:"co-export-field-selection"},h("div",{class:"co-export-field-header"},h("span",{class:"co-export-field-header-label"},TranslationController.t("export.fields")),h("span",{class:"co-export-field-header-selected-count-label"},TranslationController.t("export.selectedFields",{count:this.selectedFieldCount}))),h("div",{class:"co-export-field-content"},h("div",{class:"co-export-field-content-header"},h("fw-checkbox",{class:"co-export-field-select-all",checked:this.allFieldsSelected,onFwChange:this.selectAllFieldsChangeHandler},h("span",{class:"co-export-field-select-all-label"},TranslationController.t("export.selectAllFields"))),x&&h("fw-input",{"clear-input":true,"icon-left":"search",placeholder:TranslationController.t("export.searchFieldsPrompt"),onFwInput:this.debouncedHandleInput,onFwInputClear:this.clearSearchHandler,class:"co-export-field-search"})),h("div",{class:"co-export-field-content-fields"},!u&&h("div",{class:C},m),!u&&g&&h("div",{class:"co-export-field-content-fields-column2"},w),u&&h("span",{class:"co-export-field-empty-search-message"},TranslationController.t("export.noSearchResults"))))))),h("fw-modal-footer",null,h("span",{class:"co-export-modal-footer"},h("fw-button",{color:"secondary",onFwClick:this.closeModalHandler},TranslationController.t("export.cancelButton")),h("fw-button",{onFwClick:this.exportHandler},TranslationController.t("export.submitButton")))))};Object.defineProperty(e.prototype,"host",{get:function(){return getElement(this)},enumerable:false,configurable:true});return e}();CoExport.style=coExportCss;export{CoExport as fw_co_export};
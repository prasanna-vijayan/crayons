import{r as t,c as i,h as e,g as s}from"./p-a21f6813.js";import{T as o}from"./p-c3aeca37.js";import{h as n}from"./p-12253190.js";import{v as r}from"./p-5a4641f9.js";import"./p-b683e35d.js";const h=class{constructor(e){t(this,e),this.fwFilterChange=i(this,"fwFilterChange",7),this.identifier=r(),this.sourceFilterOptions=[],this.filterConditions={},this.showSearch=!0,this.filters={},this.conditionSchema={}}onSelection(t){const{value:i,id:e,meta:s}=t.detail;if("searchDropdown"===e){const{value:e}=s.selectedOptions[0];this.filterOptions=this.filterOptions.filter((t=>t.value!==i));const{type:o}=this.filters[e];if(!o)throw Error(`Filter type is not defined for ${e}`);if(!this.conditionSchema[o])throw Error(`Condition schema type is not defined for ${o}`);this.filterConditions[e]={},this.filterConditions=Object.assign({},this.filterConditions),t.stopImmediatePropagation(),t.stopPropagation(),this.showSearch=!1}}onConditionDelete(t){delete this.filterConditions[t.detail.value],this.setFilterOptions(Object.keys(this.filterConditions)),this.emitFilterSelection(this.filterConditions),t.stopImmediatePropagation(),t.stopPropagation()}onFiltersChange(t){this.setFilterOptions(t)}onFilterConditions(t){this.emitFilterSelection(t)}async getValue(){const t={},i=Array.from(this.host.shadowRoot.querySelectorAll("fw-filter-condition")).map((i=>i.isValid().then((e=>e?Promise.resolve(t[i.filterOn]={condition:i.selectedCondition,value:i.valueState}):Promise.reject("Invalid Filter")))));return Promise.all(i).then((()=>{const i=this.orderCondition(t);return this.saveCurrentState(i),Promise.resolve(i)})).catch((t=>Promise.reject(t)))}async clearFilter(){this.filterOptions=this.sourceFilterOptions,this.filterConditions={},this.initialFilterConditions={},this.showSearch=!0}async resetFilter(){this.sourceFilterOptions.length>0&&this.loadSavedState()}orderCondition(t){return Object.keys(this.filterConditions).reduce(((i,e)=>(i[e]=t[e],i)),{})}isFiltersAvailable(){return this.filterConditions&&Object.keys(this.filterConditions).length>0}setSourceFilterOptions(t){this.sourceFilterOptions=Object.keys(t).map((i=>Object.assign(Object.assign({},t[i]),{value:i})))}getDefaultCondition(t){return Object.keys(t).filter((i=>t[i].default))[0]}emitFilterSelection(t){const i=t?Object.keys(t):[];this.fwFilterChange.emit({filters:i})}setInitialState(t){this.initialFilterConditions=Object.assign({},t)||{},this.filterConditions=Object.assign({},this.initialFilterConditions),this.setFilterOptions(this.filterConditions)}saveCurrentState(t){this.initialFilterConditions=Object.assign({},t)}loadSavedState(){this.filterConditions=Object.assign({},this.initialFilterConditions),this.setFilterOptions(this.filterConditions),this.identifier=r()}setFilterOptions(t){const i=Object.keys(t);i.length>0?(this.filterOptions=this.sourceFilterOptions.filter((t=>!i.includes(t.value))),this.showSearch=!1):(this.filterOptions=this.sourceFilterOptions,this.showSearch=!0)}renderContent(t){return Object.keys(t).map((i=>{const{text:s,type:o,controlProps:n}=this.filters[i],r=this.conditionSchema[o],{value:h,condition:l=this.getDefaultCondition(r)}=t[i];return e("fw-filter-condition",Object.assign({key:i},{conditionSchema:r,filterOn:i,filterText:s,controlProps:n,value:h,condition:l,identifier:this.identifier}))}))}componentWillLoad(){this.setSourceFilterOptions(this.filters),this.setInitialState(this.value)}render(){return e("div",{class:"filter"},this.isFiltersAvailable()&&e("div",{class:"filter-content"},this.renderContent(this.filterConditions)),e("div",{class:"filter-action"},this.showSearch?e("fw-search-dropdown",{id:"searchDropdown",options:this.filterOptions}):0!==this.filterOptions.length&&e("span",{class:"add-filter",role:"button",tabIndex:0,onClick:()=>{this.showSearch=!0},onKeyDown:n((()=>{this.showSearch=!0}))},o.t("filters.addFilter"))),!this.isFiltersAvailable()&&e("slot",{name:"filter-empty-state"},e("div",{style:{display:"flex",height:"100%",alignItems:"center",justifyContent:"center"}},e("span",null,o.t("filters.noFilter")))))}get host(){return s(this)}static get watchers(){return{filters:["onFiltersChange"],filterConditions:["onFilterConditions"]}}};h.style=':host{font-family:var(--fw-font-family, -apple-system, BlinkMacSystemFont, "Segoe UI", roboto, oxygen, ubuntu, cantarell, "Open Sans", "Helvetica Neue", sans-serif);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-box-sizing:border-box;box-sizing:border-box}:host{display:block}.filter{display:block;height:100%}.filter .add-filter{display:inline-block;color:#2c5cc5;line-height:20px;font-weight:600;font-size:14px;cursor:pointer}.filter-action{-webkit-margin-before:12px;margin-block-start:12px}.filter-content{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}';export{h as fw_filter}